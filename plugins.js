(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{60:function(e,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,i=t(s(2)),r=function(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};o.get||o.set?Object.defineProperty(a,s,o):a[s]=e[s]}return a.default=e,a}(s(0));t(s(1)),t(s(64));function t(e){return e&&e.__esModule?e:{default:e}}function n(e,a,s,i){o||(o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,t=arguments.length-3;if(a||0===t||(a={children:void 0}),a&&r)for(var n in r)void 0===a[n]&&(a[n]=r[n]);else a||(a=r||{});if(1===t)a.children=i;else if(t>1){for(var l=new Array(t),d=0;d<t;d++)l[d]=arguments[d+3];a.children=l}return{$$typeof:o,type:e,key:void 0===s?null:""+s,ref:null,props:a,_owner:null}}function l(e,a,s){return a in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s,e}function d(){return(d=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e}).apply(this,arguments)}function p(e,a){if(null==e)return{};var s,o,i=function(e,a){if(null==e)return{};var s,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)s=r[o],a.indexOf(s)>=0||(i[s]=e[s]);return i}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)s=r[o],a.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}const u=e=>{let{to:a}=e,s=p(e,["to"]);return a.includes("http")?r.default.createElement("a",d({},e,{href:a})):("#"===a[0]&&(a=i.default.join("/auto-release/","pages/plugins.html")+a),r.default.createElement("a",d({},s,{href:a,onClick:s=>{if(s.preventDefault(),"#"===e.to)return!1;const o=new URL(i.default.join(window.location.origin,a));window.history.pushState((e=>({href:e.href,pathname:e.pathname,hash:e.hash,query:e.query}))(o),null,a),e.onClick();const r=new CustomEvent("changeLocation",{detail:o});return dispatchEvent(r),!1}})))};u.defaultProps={href:"",onClick:()=>{}};const c=e=>{var a,s;return s=a=class extends r.default.Component{constructor(...e){super(...e),l(this,"state",{Comp:null})}componentDidMount(){!this.state.Comp&&this.props.shouldLoad&&e().then(e=>{this.setState({Comp:e.default})})}render(){const{Comp:e}=this.state;return e?r.default.createElement(e,this.props,this.props.children||null):null}},l(a,"defaultProps",{shouldLoad:!0}),s};c(()=>s.e(24).then(s.bind(null,65))),c(()=>s.e(24).then(s.bind(null,66)));var h=n("h1",{},void 0,"Plugins"),g=n("code",{},void 0,"auto"),v=n("p",{},void 0,"There are three ways to load a plugin."),m=n("p",{},void 0,"To use an official plugin all you have to do is supply the name. Currently the only supported plugin is the ",n("code",{},void 0,"npm")," plugin."),f=n("pre",{},void 0,n("code",{className:"language-sh"},void 0,"auto shipit --plugins npm",n("br",{}))),b=n("code",{},void 0,"npm"),y=n("p",{},void 0,"If you are using a plugin distributed on ",n("code",{},void 0,"npm")," simply supply the name."),N=n("pre",{},void 0,n("code",{className:"language-sh"},void 0,"auto shipit --plugins NPM_PACKAGE_NAME",n("br",{}))),j=n("p",{},void 0,"Or if you have a plugin locally supply the path."),k=n("pre",{},void 0,n("code",{className:"language-sh"},void 0,"auto shipit --plugins ../path/to/plugin.js",n("br",{}))),w=n("p",{},void 0,"If you want to use multiple plugins you can supply multiple."),P=n("pre",{},void 0,n("code",{className:"language-sh"},void 0,"auto shipit --plugins npm NPM_PACKAGE_NAME ../path/to/plugin.js",n("br",{}))),O=n("p",{},void 0,"Plugins work by hooking into various actions that ",n("code",{},void 0,"auto")," has to do in order to facilitate a release or interact with your GitHub repo. The hooks that it exposes are:"),M=n("ul",{},void 0,n("li",{},void 0,"beforeRun - Happens before anything is done. This is a great place to check for platform specific secrets such as a NPM token."),n("li",{},void 0,"getAuthor - Get git author"),n("li",{},void 0,"getPreviousVersion - Get the previous version"),n("li",{},void 0,"getRepository - Get owner/repo"),n("li",{},void 0,"publish - Publish the package")),x=n("p",{},void 0,"To create a plugin simply make a class with an ",n("code",{},void 0,"apply")," method and tap into the hooks you need."),C=n("pre",{},void 0,n("code",{className:"language-ts"},void 0,n("span",{className:"hljs-keyword"},void 0,"import")," * ",n("span",{className:"hljs-keyword"},void 0,"as")," fs ",n("span",{className:"hljs-keyword"},void 0,"from")," ",n("span",{className:"hljs-string"},void 0,"'fs'"),";",n("br",{}),n("span",{className:"hljs-keyword"},void 0,"import")," { promisify } ",n("span",{className:"hljs-keyword"},void 0,"from")," ",n("span",{className:"hljs-string"},void 0,"'util'"),";",n("br",{}),n("br",{}),n("span",{className:"hljs-keyword"},void 0,"import")," { IAutoHooks, AutoRelease, SEMVER, execPromise } ",n("span",{className:"hljs-keyword"},void 0,"from")," ",n("span",{className:"hljs-string"},void 0,"'auto'"),";",n("br",{}),n("span",{className:"hljs-keyword"},void 0,"import")," getConfigFromPackageJson ",n("span",{className:"hljs-keyword"},void 0,"from")," ",n("span",{className:"hljs-string"},void 0,"'./package-config'"),";",n("br",{}),n("br",{}),n("span",{className:"hljs-keyword"},void 0,"const")," readFile = promisify(fs.readFile);",n("br",{}),n("br",{}),n("span",{className:"hljs-keyword"},void 0,"export")," ",n("span",{className:"hljs-keyword"},void 0,"default")," ",n("span",{className:"hljs-keyword"},void 0,"class")," NPMPlugin {",n("br",{}),"  ",n("span",{className:"hljs-keyword"},void 0,"public")," apply(auto: AutoRelease) {",n("br",{}),"    auto.hooks.getAuthor.tapPromise(",n("span",{className:"hljs-string"},void 0,"'NPM'"),", ",n("span",{className:"hljs-keyword"},void 0,"async")," () => {",n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"const")," { author } = ",n("span",{className:"hljs-built_in"},void 0,"JSON"),".parse(",n("span",{className:"hljs-keyword"},void 0,"await")," readFile(",n("span",{className:"hljs-string"},void 0,"'package.json'"),", ",n("span",{className:"hljs-string"},void 0,"'utf-8'"),"));",n("br",{}),n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"if")," (author) {",n("br",{}),"        auto.logger.log.info(",n("span",{className:"hljs-string"},void 0,"'NPM: Got author information from package.json'"),");",n("br",{}),"        ",n("span",{className:"hljs-keyword"},void 0,"return")," author;",n("br",{}),"      }",n("br",{}),"    });",n("br",{}),n("br",{}),"    auto.hooks.getPreviousVersion.tapPromise(",n("span",{className:"hljs-string"},void 0,"'NPM'"),", ",n("span",{className:"hljs-keyword"},void 0,"async")," prefixRelease => {",n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"const")," { version } = ",n("span",{className:"hljs-built_in"},void 0,"JSON"),".parse(",n("span",{className:"hljs-keyword"},void 0,"await")," readFile(",n("span",{className:"hljs-string"},void 0,"'package.json'"),", ",n("span",{className:"hljs-string"},void 0,"'utf-8'"),"));",n("br",{}),n("br",{}),"      auto.logger.log.info(",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'NPM: Got previous version from package.json - '"),",",n("br",{}),"        version",n("br",{}),"      );",n("br",{}),n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"if")," (version) {",n("br",{}),"        ",n("span",{className:"hljs-keyword"},void 0,"return")," prefixRelease(",n("br",{}),"          ",n("span",{className:"hljs-built_in"},void 0,"JSON"),".parse(",n("span",{className:"hljs-keyword"},void 0,"await")," readFile(",n("span",{className:"hljs-string"},void 0,"'package.json'"),", ",n("span",{className:"hljs-string"},void 0,"'utf-8'"),")).version",n("br",{}),"        );",n("br",{}),"      }",n("br",{}),"    });",n("br",{}),n("br",{}),"    auto.hooks.getRepository.tapPromise(",n("span",{className:"hljs-string"},void 0,"'NPM'"),", ",n("span",{className:"hljs-keyword"},void 0,"async")," () => {",n("br",{}),"      auto.logger.log.info(",n("span",{className:"hljs-string"},void 0,"'NPM: getting repo information from package.json'"),");",n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"return")," getConfigFromPackageJson();",n("br",{}),"    });",n("br",{}),n("br",{}),"    auto.hooks.publish.tapPromise(",n("span",{className:"hljs-string"},void 0,"'NPM'"),", ",n("span",{className:"hljs-keyword"},void 0,"async")," (version: SEMVER) => {",n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"await")," execPromise(",n("span",{className:"hljs-string"},void 0,"'npm'"),", [",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'version'"),",",n("br",{}),"        version,",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'-m'"),",",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'Bump version to: %s [skip ci]'"),n("br",{}),"      ]);",n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"await")," execPromise(",n("span",{className:"hljs-string"},void 0,"'npm'"),", [",n("span",{className:"hljs-string"},void 0,"'publish'"),"]);",n("br",{}),"      ",n("span",{className:"hljs-keyword"},void 0,"await")," execPromise(",n("span",{className:"hljs-string"},void 0,"'git'"),", [",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'push'"),",",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'--follow-tags'"),",",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'--set-upstream'"),",",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'origin'"),",",n("br",{}),"        ",n("span",{className:"hljs-string"},void 0,"'$branch'"),n("br",{}),"      ]);",n("br",{}),"    });",n("br",{}),"  }",n("br",{}),"}",n("br",{})));var E=e=>n("div",{className:e.className},void 0,n("section",{},void 0,h,n("p",{},void 0,g," uses the package ",n(u,{currentPage:e.currentPage,target:"_blank",to:"https://github.com/webpack/tapable",className:"external-link"},void 0,"tapable")," to expose a plugin system. If you've ever written a webpack plugin it's a lot like that."),n("h2",{id:"using-plugins"},void 0,"Using Plugins ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#using-plugins","aria-hidden":"true"})),n("p",{},void 0,"To use a plugin you can either supply the plugin via a CLI arg or in your ",n(u,{currentPage:e.currentPage,to:"/auto-release/pages/autorc.html#plugins"},void 0,".autorc"),"."),v,n("h3",{id:"1.-official-plugins"},void 0,"1. Official Plugins ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#1.-official-plugins","aria-hidden":"true"})),m,f,n("h3",{id:"2.-npm-package"},void 0,"2. ",b," package ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#2.-npm-package","aria-hidden":"true"})),y,N,n("h3",{id:"3.-path"},void 0,"3. Path ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#3.-path","aria-hidden":"true"})),j,k,n("h3",{id:"multiple"},void 0,"Multiple ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#multiple","aria-hidden":"true"})),w,P,n("h2",{id:"writing-plugins"},void 0,"Writing Plugins ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#writing-plugins","aria-hidden":"true"})),n("h3",{id:"hooks"},void 0,"Hooks ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#hooks","aria-hidden":"true"})),O,M,n("h3",{id:"example-plugin---npm"},void 0,"Example Plugin - NPM ",n(u,{currentPage:e.currentPage,className:"fas fa-hashtag headerLink",to:"#example-plugin---npm","aria-hidden":"true"})),x,C));a.default=E,e.exports=a.default}}]);
//# sourceMappingURL=plugins.js.map